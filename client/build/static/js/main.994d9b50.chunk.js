(this["webpackJsonpmern-client"]=this["webpackJsonpmern-client"]||[]).push([[0],{201:function(e,t){},215:function(e,t,n){},443:function(e,t,n){"use strict";n.r(t);var a=n(3),o=n.n(a),r=n(72),c=n.n(r),i=(n(215),n(24)),s=n(35),l=n(36),d=n(9),u=n(206),j=n(454),b=n(456),m=n(453),h=n(205),p=n(64),O=n(2),x=function(e){var t=e.restroom;return Object(O.jsxs)("div",{children:[Object(O.jsx)("h3",{children:t.name}),Object(O.jsx)("h4",{children:"".concat(t.street,", ").concat(t.city,", ").concat(t.state)})]})},f=n(196);function g(){var e=Object(a.useState)(0),t=Object(i.a)(e,2),n=t[0],o=t[1];return Object(O.jsxs)("div",{className:"container my-1",form:{type:"text"},style:{backgroundColor:"blue"},children:[Object(O.jsxs)("form",{children:[Object(O.jsxs)("label",{style:{fontWeight:"bold"},children:["Written Review:",Object(O.jsx)("textArea",{style:{width:"601px",height:"100px"},type:"text",Review:"review"})]}),Object(O.jsx)("input",{type:"submit",value:"Submit"})]}),Object(O.jsx)(f.Rating,{onClick:function(e){o(e)},ratingValue:n}),Object(O.jsx)("form",{type:"text",name:"field[]"})]})}var v,w,y,k,N=Object(p.GoogleApiWrapper)({apiKey:"AIzaSyCYXrxhue2vZfkXo6rIlk_uapWKN3wbQ9o"})((function(e){var t=Object(a.useState)(null),n=Object(i.a)(t,2),o=n[0],r=n[1],c=Object(a.useState)(null),s=Object(i.a)(c,2),l=s[0],d=s[1],u=e.latitude,j=e.longitude;return Object(a.useEffect)((function(){u&&j&&fetch("https://www.refugerestrooms.org/api/v1/restrooms/by_location?page=1&per_page=10&offset=0&lat=".concat(u,"&lng=").concat(j)).then((function(e){return e.json()})).then((function(e){r(e)}))}),[u,j]),Object(O.jsx)("div",{className:"map-area",children:Object(O.jsxs)(p.Map,{google:e.google,zoom:13,center:{lat:u,lng:j},children:[o&&o.map((function(e){return Object(O.jsx)(p.Marker,{position:{lat:e.latitude,lng:e.longitude},onClick:function(){return d(e)},clickable:!0},e.id)})),l&&Object(O.jsxs)(p.InfoWindow,{onCloseClick:function(){d(null)},position:{lat:l.latitude,lng:l.longitude},visible:null!==l,children:[Object(O.jsx)(x,{restroom:l}),Object(O.jsx)(g,{})]})]})})})),S=n(62),C=n(40),$=n.n(C),R=n(63),W=n(457),A=n(74),I=n(455),_=(Object(I.a)(v||(v=Object(A.a)(["\n  mutation ratings($email: String!, $password: String!) {\n    Rating(email: $email, password: $password) {\n      token\n      user {\n        _id\n      }\n    }\n  }\n"]))),Object(I.a)(w||(w=Object(A.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n      }\n    }\n  }\n"])))),E=(Object(I.a)(y||(y=Object(A.a)(["\n  mutation addDonation($donation: [ID]!) {\n    addDonation(donation: $donation) {\n      purchaseDate\n      donation {\n        _id\n        name\n        usdAmt\n      }\n    }\n  }\n"]))),Object(I.a)(k||(k=Object(A.a)(["\n  mutation addUser(\n    $firstName: String!\n    $lastName: String!\n    $email: String!\n    $password: String!\n  ) {\n    addUser(\n      firstName: $firstName\n      lastName: $lastName\n      email: $email\n      password: $password\n    ) {\n      token\n      user {\n        _id\n      }\n    }\n  }\n"])))),L=n(97),T=n(98),D=n(130),F=n.n(D),P=new(function(){function e(){Object(L.a)(this,e)}return Object(T.a)(e,[{key:"getProfile",value:function(){return F()(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return F()(e).exp<Date.now()/1e3}catch(t){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}());var U=function(e){var t=Object(a.useState)({email:"",password:""}),n=Object(i.a)(t,2),o=n[0],r=n[1],c=Object(W.a)(_),d=Object(i.a)(c,2),u=d[0],j=d[1].error,b=function(){var e=Object(R.a)($.a.mark((function e(t){var n,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,u({variables:{email:o.email,password:o.password}});case 4:n=e.sent,a=n.data.login.token,P.login(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),m=function(e){var t=e.target,n=t.name,a=t.value;r(Object(s.a)(Object(s.a)({},o),{},Object(S.a)({},n,a)))};return Object(O.jsxs)("div",{className:"container my-1",children:[Object(O.jsx)(l.b,{to:"/signup",children:"\u2190 Go to Signup"}),Object(O.jsx)("h2",{children:"Login"}),Object(O.jsxs)("form",{onSubmit:b,children:[Object(O.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(O.jsx)("label",{htmlFor:"email",children:"Email address:"}),Object(O.jsx)("input",{placeholder:"youremail@test.com",name:"email",type:"email",id:"email",onChange:m})]}),Object(O.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(O.jsx)("label",{htmlFor:"pwd",children:"Password:"}),Object(O.jsx)("input",{placeholder:"******",name:"password",type:"password",id:"pwd",onChange:m})]}),j?Object(O.jsx)("div",{children:Object(O.jsx)("p",{className:"error-text",children:"The provided credentials are incorrect"})}):null,Object(O.jsx)("div",{className:"flex-row flex-end",children:Object(O.jsx)("button",{type:"submit",children:"Submit"})})]})]})};var M=function(e){var t=Object(a.useState)({email:"",password:""}),n=Object(i.a)(t,2),o=n[0],r=n[1],c=Object(W.a)(E),d=Object(i.a)(c,1)[0],u=function(){var e=Object(R.a)($.a.mark((function e(t){var n,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,d({variables:{email:o.email,password:o.password,firstName:o.firstName,lastName:o.lastName}});case 3:n=e.sent,a=n.data.addUser.token,P.login(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(e){var t=e.target,n=t.name,a=t.value;r(Object(s.a)(Object(s.a)({},o),{},Object(S.a)({},n,a)))};return Object(O.jsxs)("div",{className:"container my-1",children:[Object(O.jsx)(l.b,{to:"/login",children:"\u2190 Go to Login"}),Object(O.jsx)("h2",{children:"Signup"}),Object(O.jsxs)("form",{onSubmit:u,children:[Object(O.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(O.jsx)("label",{htmlFor:"firstName",children:"First Name:"}),Object(O.jsx)("input",{placeholder:"First",name:"firstName",type:"firstName",id:"firstName",onChange:j})]}),Object(O.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(O.jsx)("label",{htmlFor:"lastName",children:"Last Name:"}),Object(O.jsx)("input",{placeholder:"Last",name:"lastName",type:"lastName",id:"lastName",onChange:j})]}),Object(O.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(O.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(O.jsx)("input",{placeholder:"youremail@test.com",name:"email",type:"email",id:"email",onChange:j})]}),Object(O.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(O.jsx)("label",{htmlFor:"pwd",children:"Password:"}),Object(O.jsx)("input",{placeholder:"******",name:"password",type:"password",id:"pwd",onChange:j})]}),Object(O.jsx)("div",{className:"flex-row flex-end",children:Object(O.jsx)("button",{type:"submit",children:"Submit"})})]})]})},G=n(201),z=n.n(G),B=n(202),H=function(e){var t=e.id;return Object(O.jsx)(B.Pin,Object(s.a)({onClick:function(e){console.log(t)}},e))};var J=function(){return Object(O.jsxs)("header",{className:"flex-row px-1",children:[Object(O.jsx)("h1",{children:Object(O.jsxs)(l.b,{to:"/",children:[Object(O.jsx)("span",{role:"img","aria-label":"Toilet"}),"Spot-A-Pot"]})}),Object(O.jsx)("nav",{children:P.loggedIn()?Object(O.jsxs)("ul",{className:"flex-row",children:[Object(O.jsx)("li",{className:"mx-1",children:Object(O.jsx)(l.b,{to:"/Home",children:"Home"})}),Object(O.jsx)("li",{className:"mx-1",children:Object(O.jsx)("a",{href:"/",onClick:function(){return P.logout()},children:"Logout"})})]}):Object(O.jsxs)("ul",{className:"flex-row",children:[Object(O.jsx)("li",{className:"mx-1",children:Object(O.jsx)(l.b,{to:"/signup",children:"Signup"})}),Object(O.jsx)("li",{className:"mx-1",children:Object(O.jsx)(l.b,{to:"/login",children:"Login"})})]})})]})},K=n(208),X=n(207),q=function(e){Object(K.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(L.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={loading:!0,restroom:null},e}return Object(T.a)(n,[{key:"componentDidMount",value:function(){var e=Object(R.a)($.a.mark((function e(){var t,n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://www.refugerestrooms.org/api/v1/restrooms",e.next=3,fetch("https://www.refugerestrooms.org/api/v1/restrooms");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,this.setState({restroom:n.results,loading:!1}),console.log(n);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(O.jsx)("div",{children:this.state.loading||!this.state.restroom?Object(O.jsx)("div",{children:"loading..."}):(this.state.Restrooms.name,this.state.Restrooms.accessible,this.state.Restrooms.unisex,Object(O.jsx)("div",{children:this.state.Restrooms.comment}))})}}]),n}(o.a.Component);var Q=function(e){return Object(O.jsx)("div",{className:"wrapper",children:e.children})},V=Object(u.a)({uri:"/graphql"}),Y=Object(h.a)((function(e,t){var n=t.headers,a=localStorage.getItem("id_token");return{headers:Object(s.a)(Object(s.a)({},n),{},{authorization:a?"Bearer ".concat(a):""})}})),Z=new j.a({link:Y.concat(V),cache:new b.a});var ee=function(){var e=Object(a.useState)({latitude:null,longitude:null}),t=Object(i.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){!function(){function e(e){var t=e.coords.latitude,n=e.coords.longitude;console.log(t,n),o({latitude:t,longitude:n})}function t(){console.log("Unable to retrieve your location")}navigator.geolocation?navigator.geolocation.getCurrentPosition(e,t):console.log("Geolocation is not supported by your browser")}()}),[]),Object(O.jsx)(m.a,{client:Z,children:Object(O.jsxs)(l.a,{children:[Object(O.jsx)(J,{}),Object(O.jsx)(Q,{children:Object(O.jsxs)(d.c,{children:[Object(O.jsx)(d.a,{exact:!0,path:"/",children:Object(O.jsx)(N,{latitude:n.latitude,longitude:n.longitude})}),Object(O.jsx)(d.a,{exact:!0,path:"/Restroom",component:q}),Object(O.jsx)(d.a,{exact:!0,path:"/Login",component:U}),Object(O.jsx)(d.a,{exact:!0,path:"/Marker",component:H}),Object(O.jsx)(d.a,{exact:!0,path:"/Nav",component:J}),Object(O.jsx)(d.a,{exact:!0,path:"/Rating",component:z.a}),Object(O.jsx)(d.a,{exact:!0,path:"/SignUp",component:M})]})})]})})},te=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ne(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(Object(O.jsx)(o.a.StrictMode,{children:Object(O.jsx)(ee,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");te?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ne(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ne(t,e)}))}}()}},[[443,1,2]]]);
//# sourceMappingURL=main.994d9b50.chunk.js.map